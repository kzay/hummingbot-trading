# EPP v2.4 — Bot A (Primary Strategy)
# Mode is controlled by BOT_MODE env var (paper|live), NOT by this file.
id: epp_v2_4_bot_a
controller_name: epp_v2_4
controller_type: market_making

# ── Connector ──────────────────────────────────────────────────────
connector_name: bitget_perpetual
connector_type: perp
trading_pair: BTC-USDT

# ── Order sizing ───────────────────────────────────────────────────
total_amount_quote: 50
buy_spreads: "0.0025,0.0035"
sell_spreads: "0.0025,0.0035"
buy_amounts_pct: "50,50"
sell_amounts_pct: "50,50"
executor_refresh_time: 150
cooldown_time: 5
leverage: 1
position_mode: ONEWAY
stop_loss: 0.002
take_profit: 0.004
time_limit: 300
take_profit_order_type: LIMIT
skip_rebalance: true

# ── Identity ───────────────────────────────────────────────────────
variant: a
enabled: true
no_trade: false
instance_name: bot1
log_dir: /home/hummingbot/logs

# ── Fee model ──────────────────────────────────────────────────────
fee_mode: auto
fee_profile: vip0
require_fee_resolution: true
spot_fee_pct: 0.0010
slippage_est_pct: 0.0005
turnover_cap_x: 3.0
turnover_penalty_step: 0.0005

# ── Hard risk caps (paper experiment) ───────────────────────────────
# Today's turnover already accumulated before the edge gate was enforced.
# Raise the hard stop so the bot can continue under the corrected gating logic.
max_daily_turnover_x_hard: 12.0

# ── Edge gate ──────────────────────────────────────────────────────
# Raise minimum edge to avoid marginal churn (fees+drift).
min_net_edge_bps: 15
edge_resume_bps: 4
edge_state_hold_s: 120
edge_gate_ewma_period: 8

# ── Execution safety ────────────────────────────────────────────────
# Cap concurrent executors to avoid runaway churn / memory growth.
max_active_executors: 30

# ── Derisk spread ───────────────────────────────────────────────────
# During derisk-only mode, place close-out orders this close to mid
# so they fill quickly without chasing a large adverse move.
derisk_spread_pct: 0.0003

# ── Perp inventory ────────────────────────────────────────────────
# Delta-neutral: target net exposure = 0 for balanced MM
perp_target_net_base_pct: 0.0
min_base_pct: 0.0
# Lower derisk trigger from 0.90 → 0.60 so position is capped earlier
# and the derisk cycle completes before large adverse moves.
max_base_pct: 0.60

# ── Drift protection ──────────────────────────────────────────────
adverse_drift_ewma_alpha: 0.25
drift_spike_threshold_bps: 5
drift_spike_mult_max: 1.8

# ── Sampling ───────────────────────────────────────────────────────
sample_interval_s: 10
spread_floor_recalc_s: 30
cancel_budget_per_min: 50

# ── Paper simulation params (only active when BOT_MODE=paper) ─────
paper_equity_quote: 500
# IMPORTANT: disable the paper edge-gate bypass so min_net_edge_bps is enforced.
paper_edge_gate_bypass: false
paper_seed: 7
paper_latency_ms: 150
paper_queue_participation: 0.35
paper_slippage_bps: 1.0
paper_adverse_selection_bps: 1.5
paper_partial_fill_min_ratio: 0.15
paper_partial_fill_max_ratio: 0.85
paper_max_fills_per_order: 8

# ── Regime overrides ────────────────────────────────────────────────
# For delta-neutral perp MM: remove one-sided extremes in up/down
# so the bot quotes two-sided with inventory skew instead of
# accumulating pure directional exposure.
regime_specs_override:
  up:
    one_sided: "off"
    spread_min: "0.0030"
    spread_max: "0.0060"
    target_base_pct: "0.0"
  down:
    one_sided: "off"
    spread_min: "0.0030"
    spread_max: "0.0060"
    target_base_pct: "0.0"
  neutral_low_vol:
    target_base_pct: "0.0"
