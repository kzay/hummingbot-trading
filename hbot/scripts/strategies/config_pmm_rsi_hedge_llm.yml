# ============================================================================
#  PMM + RSI + Hedge + LLM Sentiment — Configuration Reference
# ============================================================================
#
#  This file documents every tunable parameter.  To use it, either:
#    1. Edit the constants directly in pmm_rsi_hedge_llm.py  (recommended)
#    2. Or load this YAML at runtime via a custom loader.
#
#  Start command:
#    >>> start --script pmm_rsi_hedge_llm.py
#
# ============================================================================

# ---- Exchange & Market ---------------------------------------------------
exchange_spot: "binance"                  # spot connector name
exchange_perp: "binance_perpetual"        # perpetual connector (for hedging)
trading_pair: "BTC-USDT"                  # must match on both connectors

# ---- Pure Market Making --------------------------------------------------
base_bid_spread: 0.002                    # 0.2 %  — base bid distance from mid
base_ask_spread: 0.002                    # 0.2 %  — base ask distance from mid
order_amount: 0.001                       # base-asset units per order per side
order_refresh_secs: 30                    # seconds between order cancel+replace
order_levels: 1                           # number of orders per side
order_level_spread: 0.001                 # additional spread per extra level
min_spread: 0.0005                        # hard floor (0.05 %)
max_spread: 0.02                          # hard ceiling (2.0 %)

# ---- RSI Mean-Reversion -------------------------------------------------
rsi_enabled: true
rsi_period: 14                            # look-back in candles
rsi_oversold: 30.0                        # buy signal threshold
rsi_overbought: 70.0                      # sell signal threshold
rsi_spread_factor: 0.5                    # max ±50 % spread adjustment from RSI
candle_interval_secs: 60                  # synthetic candle aggregation (seconds)
price_history_size: 200                   # rolling window of candles

# ---- ATR Volatility Filter ----------------------------------------------
atr_enabled: true
atr_period: 14                            # candles for ATR calculation
atr_pause_multiplier: 3.0                 # pause orders if ATR/mid > base_spread * N
atr_widen_multiplier: 1.5                 # widen spreads if ATR exceeds this

# ---- Hedging (Perpetual Futures HEDGE mode) ------------------------------
hedge_enabled: true
hedge_leverage: 5                         # 1–10 ×  (set on exchange too)
hedge_inventory_threshold: 0.5            # 50 % imbalance triggers hedge rebalance
hedge_rebalance_secs: 60                  # how often to check inventory for hedging

# ---- LLM Sentiment ------------------------------------------------------
llm_enabled: true
llm_provider: "grok"                      # "grok" (xAI) or "openai"
llm_api_key: ""                           # set via LLM_API_KEY env var preferred
llm_fallback_provider: "openai"
llm_fallback_api_key: ""                  # set via LLM_FALLBACK_API_KEY env var
llm_query_interval_secs: 600              # 10 min between queries
llm_request_timeout: 15                   # seconds per HTTP call
llm_spread_factor: 0.3                    # max ±30 % spread shift from sentiment

# ---- Risk Management / Triple-Barrier -----------------------------------
tp_pct: 0.03                              # take profit  3 %
sl_pct: 0.015                             # stop loss    1.5 %
max_hold_secs: 7200                       # time exit    2 hours
max_position_pct: 0.02                    # max 2 % capital per order
kill_switch_loss_pct: 0.10                # halt strategy at 10 % portfolio drawdown

# ---- Mode ----------------------------------------------------------------
paper_trade: false                        # true = use paper-trade connectors

# ============================================================================
#  Exchange-Specific Notes
# ============================================================================
#
#  Binance:
#    spot connector  = "binance"
#    perp connector  = "binance_perpetual"
#    Enable HEDGE mode in Binance Futures settings before running.
#
#  Bybit:
#    spot connector  = "bybit"
#    perp connector  = "bybit_perpetual"
#
#  Bitget:
#    spot connector  = "bitget"
#    perp connector  = "bitget_perpetual"
#
#  Pair format is always BASE-QUOTE, e.g. "BTC-USDT", "ETH-USDT".
#
# ============================================================================
#  LLM API Keys
# ============================================================================
#
#  Preferred: set as environment variables (never commit keys)
#
#    export LLM_API_KEY="xai-xxxxxx"              # Grok / xAI
#    export LLM_FALLBACK_API_KEY="sk-xxxxxx"      # OpenAI fallback
#
#  Or add to env/.env and reference in docker-compose.yml:
#
#    LLM_API_KEY=xai-xxxxxx
#    LLM_FALLBACK_API_KEY=sk-xxxxxx
#
# ============================================================================
